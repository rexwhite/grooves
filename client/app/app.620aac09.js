"use strict";angular.module("grooves",["ngResource","ui.router","ui.bootstrap","focus-if","ct.ui.router.extras"]).config(["$urlRouterProvider","$locationProvider",function(a,b){a.otherwise("/albums"),b.html5Mode(!0)}]).run(["$rootScope","$state","$window",function(a,b,c){a.$state=b,a.ga=c.ga}]),angular.module("grooves").controller("AlbumDetailsCtrl",["$scope","$stateParams","$state","$uibModal","$filter","Album","Contribution","Artist",function(a,b,c,d,e,f,g,h){function i(a){var b=0,c=0,d=0,e=/(\d+)*:?(\d+)*:?(\d+)*/.exec(a.duration);return d=e[1],e[2]&&(c=d+":",d=e[2]),e[3]&&(b=c,c=d+":",d=e[3]),b||c?a.duration=(b?b:"00:")+(c?c:"00:")+d:a.duration=d,a}var j="MM/dd/yyyy",k={DISPLAY:1,UPDATE:2,CREATE:3};a.modes=k,a.genres="",a.tracks=[],a.contributors=[],a.artists="";var l=[],m=b.id;0===m?(a.mode=k.CREATE,a.album=new f):(a.mode=k.DISPLAY,a.album=f.get({id:b.id},function(b){a.tracks=b.tracks,a.contributors=b.contributors,a.genres=_.map(b.genres,"name").join(", "),l=b.artists,a.artists=_.map(l,"name").join(", "),b.release_date=e("date")(b.release_date,j),b.label_date=e("date")(b.label_date,j)})),a.edit_artist=function(){d.open({templateUrl:"app/main/list/album_details/artist_modal.html",controller:"artistModalCtrl",resolve:{album_artists:function(){return a.album.artists}}}).result.then(function(b){l=b,a.artists=_.map(l,"name").join(", "),a.albumForm.$setDirty(!0)})},a.edit_genres=function(){d.open({templateUrl:"app/main/list/album_details/genres_modal.html",controller:"genresModalCtrl",resolve:{album_genres:function(){return a.album.genres}}}).result.then(function(b){a.album.genres=b,a.genres=_.map(b,"name").join(", "),a.albumForm.$setDirty(!0)})},a.edit_label=function(){d.open({templateUrl:"app/main/list/album_details/label_modal.html",controller:"labelModalCtrl",resolve:{album_label:function(){return a.album.label}}}).result.then(function(b){a.album.label=b,a.album.label_id=b.id,a.albumForm.$setDirty(!0)})},a.edit_lot=function(){d.open({templateUrl:"app/main/list/album_details/lot_modal.html",controller:"lotModalCtrl",resolve:{album_lot:function(){return a.album.lot}}}).result.then(function(b){a.album.lot=b,a.album.lot_id=b.id,a.albumForm.$setDirty(!0)})},a.add_track=function(){var b={position:a.tracks.length+1,label:a.tracks.length+1},c=a.tracks.push(b)-1;a.focus="title_"+c};var n=[];a.remove_track=function(b){var c=a.tracks[b];c.id&&n.push(c),a.tracks.splice(b,1),a.albumForm.tracksForm.$setDirty(!0)},a.add_contributor=function(){d.open({templateUrl:"app/main/list/album_details/contributor_modal.html",controller:"contributorModalCtrl"}).result.then(function(b){var c={album_id:a.album.id,person_id:b.person.id,name:b.person.name,role_id:b.role.id,role:b.role.role};a.contributors.push(c),a.albumForm.contributorsForm.$setDirty(!0)})};var o=[];a.remove_contributor=function(b){var c=a.contributors[b];c.id&&o.push(c),a.contributors.splice(b,1),a.albumForm.contributorsForm.$setDirty(!0)},a.edit=function(){a.mode=k.UPDATE},a.save=function(){var b=a.albumForm.tracksForm.$dirty,d=a.albumForm.contributorsForm.$dirty,e=_.differenceBy(l,a.album.artists,"name"),f=_.differenceBy(a.album.artists,l,"name");delete a.album.tracks,a.album.release_date=new Date(a.album.release_date).toISOString(),a.album.label_date=new Date(a.album.label_date).toISOString(),a.album.$save({},function(j){for(k=0;k<e.length;k++)e[k].$addToAlbum(a.album.id);for(k=0;k<f.length;k++)h.removeFromAlbum({id:f[k].id,album_id:a.album.id});if(b){var k,l;for(k=0;k<n.length;k++)a.album.$remove_track(n[k]);for(k=0;k<a.tracks.length;k++)l=a.tracks[k],l.id?l.dirty&&a.album.$update_track(i(l)):a.album.$add_track(i(l))}if(d){var k,m;for(console.log("$scope.albumForm.contributorsForm:",a.albumForm.tracksForm.contributorsForm),k=0;k<o.length;k++)m=o[k],g["delete"]({id:m.id});for(k=0;k<a.contributors.length;k++)m=a.contributors[k],m.id||g.save(m)}c.go("main.list.album.album_list",{},{reload:!0})})},a.cancel=function(){c.go("main.list.album.album_list",{},{reload:!0})}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list.album.album_details",{url:"/albums/{id: int}",views:{album_details:{templateUrl:"app/main/list/album_details/album_details.html",controller:"AlbumDetailsCtrl"}},tab:0,html_head:{title:"Album Details"}})}]),angular.module("grooves").controller("artistModalCtrl",["$scope","$uibModalInstance","Artist","album_artists",function(a,b,c,d){a.artists=c.query(function(b){for(var c=0;c<a.artists.length;c++){var e=a.artists[c];e.checked=!!_.find(d,{name:e.name})}}),a.add=function(){var b=prompt("Artist:");c.save({name:b},function(b){a.artists.push(b)})},a.save=function(){var c=_.filter(a.artists,{checked:!0});b.close(c)}}]),angular.module("grooves").controller("contributorModalCtrl",["$scope","$q","$uibModalInstance","Person","Role",function(a,b,c,d,e){var f=a.people=d.query(),g=a.roles=e.query(),h=a.selected={person:{name:""},role:{role:""}};a.pick_user=function(a){var b=_.findIndex(f,{id:a});angular.extend(h.person,f[b])},a.pick_role=function(a){var b=_.findIndex(g,{id:a});angular.extend(h.role,g[b])},a.save=function(){var f=[];if(!h.person.id){var g=new d({name:h.person.name});f.push(g.$save({}).then(function(a){h.person=a}))}if(!h.role.id){var i=new e({role:h.role.role});f.push(i.$save({}).then(function(a){h.role=a}))}b.all(f).then(function(){c.close(a.selected)})}}]),angular.module("grooves").controller("genresModalCtrl",["$scope","$uibModalInstance","Genres","album_genres",function(a,b,c,d){a.genres=c,a.genres.$promise.then(function(){for(var b=0;b<a.genres.length;b++){var c=a.genres[b];c.checked=!!_.find(d,{name:c.name})}}),a.save=function(){var c=_.filter(a.genres,{checked:!0});b.close(c)}}]),angular.module("grooves").controller("labelModalCtrl",["$scope","$q","$uibModalInstance","Label","album_label",function(a,b,c,d,e){var f=a.labels=d.query(),g=a.selected={};a.labels.$promise.then(function(){for(var b=0;b<a.labels.length;b++){var c=a.labels[b];c.checked=!!_.find(e,{label:c.label})}}),a.pick_label=function(a){var b=_.findIndex(f,{id:a});angular.extend(g,f[b])},a.save=function(){g.id||(g=new d({label:g.label}).$save()),b.when(g).then(function(){c.close(g)})}}]),angular.module("grooves").controller("lotModalCtrl",["$scope","$q","$uibModalInstance","Lot","album_lot",function(a,b,c,d,e){var f=a.lots=d.query(),g=a.selected={};a.lots.$promise.then(function(){for(var b=0;b<a.lots.length;b++){var c=a.labels[b];c.checked=!!_.find(e,{lot:c.lot})}}),a.pick_lot=function(a){var b=_.findIndex(f,{id:a});angular.extend(g,f[b])},a.save=function(){g.id||(g=new d({lot:g.lot}).$save()),b.when(g).then(function(){c.close(g)})}}]),angular.module("grooves").controller("AlbumsCtrl",["$scope","Album",function(a,b){a.albums=b.query(),a.format=function(a,b){return _.map(a,b).join(", ")},a.remove=function(b){confirm("Delete album: "+a.albums[b].title+" ?")&&a.albums[b].$delete({},function(){a.albums.splice(b,1)})}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list.album.album_list",{url:"/albums",views:{album_list:{templateUrl:"app/main/list/albums/albums.html",controller:"AlbumsCtrl"}},tab:0})}]),angular.module("grooves").controller("GenreDetailsCtrl",["$scope","$stateParams","Genre","Album",function(a,b,c,d){var e=b.id;a.genre=c.get({id:e}),a.albums=d.query({genre_id:e}),a.format=function(a){return _.map(a,"name").join(", ")},a.remove=function(b){a.genre.$remove_album(b).then(function(){a.albums=d.query({genre_id:e})})}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list.genre.genre_details",{url:"/genre?{id: int}",views:{genre_details:{templateUrl:"app/main/list/genre_details/genre_details.html",controller:"GenreDetailsCtrl"}},tab:1})}]),angular.module("grooves").controller("GenresCtrl",["$scope","Genres",function(a,b){a.genres=b,a.addGenre=function(){var b=prompt("Genre Name:");b&&a.genres.add_genre({name:b})},a.remove=function(b){confirm("Delete genre: "+a.genres[b].name+" ?")&&a.genres.remove_genre(b)}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list.genre.genre_list",{url:"/genres",views:{genre_list:{templateUrl:"app/main/list/genres/genres.html",controller:"GenresCtrl"}},tab:1})}]),angular.module("grooves").controller("ListCtrl",["$rootScope","$scope","$state",function(a,b,c){b.tab=c.current.tab,a.$on("$stateChangeSuccess",function(){b.tab=c.current.tab}),b.pop=function(a,b){var d=c.current.name;0===d.indexOf(a)?c.go(a+"."+b):c.go(a)}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list",{templateUrl:"app/main/list/list.html",controller:"ListCtrl","abstract":!0}),a.state("main.list.album",{sticky:!0,views:{albums:{templateUrl:"app/main/list/albums.html"}},deepStateRedirect:{"default":{state:"main.list.album.album_list"}}}),a.state("main.list.genre",{sticky:!0,views:{genres:{templateUrl:"app/main/list/genres.html"}},deepStateRedirect:{"default":{state:"main.list.genre.genre_list"}}}),a.state("main.list.people",{sticky:!0,views:{people:{templateUrl:"app/main/list/people.html"}},deepStateRedirect:{"default":{state:"main.list.people.people_list"}}})}]),angular.module("grooves").controller("peopleCtrl",["$scope","Person","Role",function(a,b,c){a.people=b.query(),a.roles=c.query(),a.addPerson=function(){var c=prompt("Name:");if(c){var d=new b({name:c});d.$save({},function(b){a.people.push(b)})}},a.removePerson=function(b){confirm("Really?  You want to delete person: "+a.people[b].name+" ?")&&a.people[b].$delete({},function(){a.people.splice(b,1)})},a.addRole=function(){var b=prompt("Role:");new c({role:b}).$save({},function(b){a.roles.push(b)})},a.removeRole=function(b){confirm("Delete role: "+a.roles[b].role+" ?")&&a.roles[b].$delete({},function(){a.roles.splice(b,1)})}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.list.people.people_list",{url:"/people",views:{people_list:{templateUrl:"app/main/list/people/people.html",controller:"peopleCtrl"}},tab:2})}]),angular.module("grooves").controller("MainCtrl",["$scope","User",function(a,b){var c=a.loginForm={isOpen:!1},d=a.user=b;a.login=function(){console.log("pre-login user",a.user),d.$login(a.user.username,a.user.password).then(function(){console.log("logged in",a.user),c.isOpen=!1})},a.logout=function(){d.$logout().then(function(){console.log("logged out",a.user)})}}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main",{templateUrl:"app/main/main.html",controller:"MainCtrl","abstract":!0})}]),angular.module("grooves").controller("settingsCtrl",["$scope","User",function(a,b){a.msg="Settings page, yay!",a.user=b}]),angular.module("grooves").config(["$stateProvider",function(a){a.state("main.settings",{url:"/settings",templateUrl:"app/settings/settings.html",controller:"settingsCtrl",html_head:{title:"Settings"}})}]),angular.module("grooves").run(["$templateCache",function(a){a.put("app/main/list/album_details/album_details.html",'<div ng-dblclick=edit() style="margin-bottom: 20px" id=album_details class=container-fluid><form name=albumForm novalidate><div class="panel panel-default"><div class=panel-body><div class=form-horizontal><div class=form-group><div class=col-md-2><label class="control-label pull-right">Album Title</label></div><div class=col-md-6><div class="input-group hdr-wide"><input ng-model=album.title ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Album Artists</label></div><div class=col-md-6><div class=input-group><span ng-click=edit_artist() class=input-group-addon><div class="glyphicon glyphicon-list"></div></span><span class=form-control>{{ artists }}</span></div></div><div class=col-md-2><label class="control-label pull-right">Rating</label></div><div class=col-md-2><label class=control-label><uib-rating ng-model=album.rating></uib-rating></label></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Genres</label></div><div class=col-md-6><div class=input-group><span ng-click=edit_genres() class=input-group-addon><div class="glyphicon glyphicon-list"></div></span><span class=form-control>{{ genres }}</span></div></div><div class=col-md-2><label class="control-label pull-right">Sonics</label></div><div class=col-md-2><label class=control-label><uib-rating ng-model=album.audio_quality read-only="mode === modes.DISPLAY"></uib-rating></label></div></div></div></div></div><div class="panel panel-default"><div ng-init="deets_collapse = false" ng-click="deets_collapse = !deets_collapse" class=panel-heading><h3 class=panel-title>Details</h3></div><div uib-collapse=deets_collapse class=panel-body><div class=form-horizontal><div class=form-group><div class=col-md-2><label class="control-label pull-right">DISCOGS Link</label></div><div class=col-md-6><div class="input-group hdr-wide"><input ng-model=album.discogs_url ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div><div class=col-md-2><label class="control-label pull-right">Sleeve Condition</label></div><div class=col-md-2><label class=control-label><uib-rating ng-model=album.sleeve_condition read-only="mode === modes.DISPLAY"></uib-rating></label></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Record Label</label></div><div class=col-md-6><div class=input-group><span ng-click=edit_label() class=input-group-addon><div class="glyphicon glyphicon-list"></div></span><span class=form-control>{{ album.label.label }}</span></div></div><div class=col-md-2><label class="control-label pull-right">Album Condition</label></div><div class=col-md-2><label class=control-label><uib-rating ng-model=album.album_condition read-only="mode === modes.DISPLAY"></uib-rating></label></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Lot</label></div><div class=col-md-6><div class=input-group><span ng-click=edit_lot() class=input-group-addon><div class="glyphicon glyphicon-list"></div></span><span class=form-control>{{ album.lot.lot }}</span></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Release Date</label></div><div class=col-md-2><div class="input-group hdr-wide"><input placeholder=MM/DD/YYYY ng-model=album.release_date ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div><div class=col-md-2><label class="control-label pull-right">Label Date</label></div><div class=col-md-2><div class="input-group hdr-wide"><input placeholder=YY-MM-DD ng-model=album.label_date ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Catalog Number</label></div><div class=col-md-2><div class="input-group hdr-wide"><input ng-model=album.catalog_number ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div><div class=col-md-2><label class="control-label pull-right">UPC</label></div><div class=col-md-2><div class="input-group hdr-wide"><input ng-model=album.UPC ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Edition Number</label></div><div class=col-md-2><div class="input-group hdr-wide"><input ng-model=album.edition_number ng-disabled="mode == modes.DISPLAY" class="hdr-wide form-control"></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Weight (grams)</label></div><div class=col-md-2><div class=input-group><input ng-model=album.grams ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div><div class=col-md-2><label class="control-label pull-right">Size</label></div><div class=col-md-2><div class=input-group><input ng-model=album.size ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div><div class=col-md-2><label class="control-label pull-right">Speed</label></div><div class=col-md-2><div class=input-group><input ng-model=album.rpm ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div></div><div class=form-group><div class=col-md-2><label class="control-label pull-right">Channels</label></div><div class=col-md-1><div class="input-group hdr-wide"><input ng-model=album.channels ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div><div class=col-md-1><label class="control-label pull-right">Discs</label></div><div class=col-md-1><div class="input-group hdr-wide"><input ng-model=album.discs ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div><div class="col-md-1 col-md-offset-4"><label class="control-label pull-right">Last</label></div><div class=col-md-2><input type=checkbox ng-model=album.last ng-true-value=1 ng-false-value=0 ng-disabled="mode == modes.DISPLAY" class="form-control"></div></div></div></div></div><ng-form name=tracksForm><div ng-show="mode !== modes.DISPLAY || album.tracks.length &gt; 0" class="panel panel-default"><div ng-init="tracks_collapse = false" ng-click="tracks_collapse = !tracks_collapse" class=panel-heading><h3 class=panel-title>Tracks</h3></div><div uib-collapse=tracks_collapse class=panel-body><table class="table table-condensed"><thead><tr><th width=40 ng-if="mode !== modes.DISPLAY"></th><th width=50 ng-if="mode !== modes.DISPLAY" class=centered>Order</th><th width=60 class=centered>#</th><th width=250>Title</th><th width=90>Duration</th></tr></thead><tbody><tr ng-repeat="track in tracks | orderBy: \'position\'"><td ng-if="mode !== modes.DISPLAY" ng-click=remove_track($index) class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td ng-if="mode !== modes.DISPLAY" class=cell-compact><input ng-disabled="mode === modes.DISPLAY" ng-change="track.dirty=true" ng-model=track.position size=1 required class="cell-edit centered"></td><td class=cell-compact><input ng-disabled="mode === modes.DISPLAY" ng-change="track.dirty=true" ng-model=track.label size=1 required class="cell-edit centered"></td><td class=cell-compact><input ng-disabled="mode === modes.DISPLAY" ng-change="track.dirty=true" ng-model=track.title required focus-if="focus === \'title_{{$index}}\'" class="cell-edit"></td><td class=cell-compact><input ng-disabled="mode === modes.DISPLAY" ng-change="track.dirty=true" ng-model=track.duration required class="cell-edit"></td></tr></tbody><tfoot ng-if="mode !== modes.DISPLAY"><tr><td ng-click=add_track() class=centered><span class="glyphicon glyphicon-plus-sign"></span></td><td colspan=4>Add a track...</td></tr></tfoot></table></div></div></ng-form><ng-form name=contributorsForm><div ng-if="mode !== modes.DISPLAY || album.contributors.length &gt; 0" class="panel panel-default"><div class=panel-heading><h3 class=panel-title>Contributors</h3></div><div class=panel-body><table class="table-condensed table-bordered"><thead><tr><th width=40 ng-if="mode !== modes.DISPLAY"></th><th width=300>Name</th><th width=200>Role</th></tr></thead><tbody><tr ng-repeat="contributor in contributors"><td ng-if="mode !== modes.DISPLAY" ng-click=remove_contributor($index) class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ contributor.name }}</td><td>{{ contributor.role }}</td></tr></tbody><tfoot ng-if="mode !== modes.DISPLAY"><tr><td ng-click=add_contributor() class=centered><span class="glyphicon glyphicon-plus-sign"></span></td><td colspan=2>Add a contributor...</td></tr></tfoot></table></div></div></ng-form><div class=row><hr><div class=form-group><div class=col-md-1><label class=control-label>Notes</label></div><div class=col-md-11><textarea type=text ng-model=album.notes ng-disabled="mode == modes.DISPLAY" class=form-control></textarea></div></div></div><div class=row><hr><button ng-show="mode == modes.DISPLAY" ng-click=edit() class="btn btn-warning pull-right">Edit</button> <button ng-show="mode != modes.DISPLAY" ng-click=cancel() class="btn btn-warning pull-right">Cancel</button> <button ng-show=albumForm.$dirty ng-click=save() class="btn btn-danger pull-right">Save</button></div></form></div>'),a.put("app/main/list/album_details/artist.html",'<div id=modal-artists><div class=modal-header><h3 class="modal-title centered">Artists</h3></div><div class=modal-body><input placeholder="search"><div class=list><div ng-repeat="artist in artists" ng-click=pick_user($index)><input type=checkbox ng-model="artist.checked"><label class=genre-label>{{ artist.name }}</label></div></div></div><div class=modal-footer><span ng-click=add() class="btn btn-default pull-left">Add Artist</span><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/artist_modal.html",'<div id=modal-artists><div class=modal-header><h3 class="modal-title centered">Artists</h3></div><div class=modal-body><input placeholder="search"><div class=list><div ng-repeat="artist in artists" ng-click=pick_user($index)><input type=checkbox ng-model="artist.checked"><label class=genre-label>{{ artist.name }}</label></div></div></div><div class=modal-footer><span ng-click=add() class="btn btn-default pull-left">Add Artist</span><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/contributor.html",'<div id=modal-contrib><div class=modal-header><h3 class="modal-title centered">Contribution to Album</h3></div><div class=modal-body><div class=row><div class=col-md-6><input style="border: thin solid black; padding: 2px" ng-model=selected.person.name placeholder="&lt;Contributor&gt;"><br><div style="border: thin solid black; height: 150px; overflow: scroll"><div ng-repeat="person in people | filter:selected.person.name" ng-click=pick_user(person.id) class=choice><span>{{ person.name }}</span></div></div></div><div class=col-md-6><input style="border: thin solid black; padding: 2px" ng-model=selected.role.role placeholder="&lt;Role&gt;"><br><div style="border: thin solid black; height: 150px; overflow: scroll"><div ng-repeat="role in roles | filter:selected.role.role" ng-click=pick_role(role.id) class=choice><span>{{ role.role }}</span></div></div></div></div></div><div class=modal-footer><span ng-disabled="!selected.person.name || !selected.role.role" ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/contributor_modal.html",'<div id=modal-contrib><div class=modal-header><h3 class="modal-title centered">Contribution to Album</h3></div><div class=modal-body><div class=row><div class=col-md-6><input style="border: thin solid black; padding: 2px" ng-model=selected.person.name placeholder="&lt;Contributor&gt;"><br><div style="border: thin solid black; height: 150px; overflow: scroll"><div ng-repeat="person in people | filter:selected.person.name" ng-click=pick_user(person.id) class=choice><span>{{ person.name }}</span></div></div></div><div class=col-md-6><input style="border: thin solid black; padding: 2px" ng-model=selected.role.role placeholder="&lt;Role&gt;"><br><div style="border: thin solid black; height: 150px; overflow: scroll"><div ng-repeat="role in roles | filter:selected.role.role" ng-click=pick_role(role.id) class=choice><span>{{ role.role }}</span></div></div></div></div></div><div class=modal-footer><span ng-disabled="!selected.person.name || !selected.role.role" ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/genres.html",'<div id=modal-genres><div class=modal-header><h3 class="modal-title centered">Select Genres:</h3></div><div class=modal-body><div class=list><div ng-repeat="genre in genres" ng-click=pick_user($index)><input type=checkbox ng-model="genre.checked"><label class=genre-label>{{ genre.name }}</label></div></div></div><div class=modal-footer><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/genres_modal.html",'<div id=modal-genres><div class=modal-header><h3 class="modal-title centered">Select Genres:</h3></div><div class=modal-body><div class=list><div ng-repeat="genre in genres" ng-click=pick_user($index)><input type=checkbox ng-model="genre.checked"><label class=genre-label>{{ genre.name }}</label></div></div></div><div class=modal-footer><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/label_modal.html",'<div id=modal-label><div class=modal-header><h3 class="modal-title centered">Album Label:</h3></div><div class=modal-body><input ng-model=selected.label placeholder="&lt;Album Label&gt;"><br><div id=label-list><div ng-repeat="label in labels | filter:selected.label" ng-click=pick_label(label.id) class=choice><span>{{ label.label }}</span></div></div></div><div class=modal-footer><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/album_details/lot_modal.html",'<div id=modal-lot><div class=modal-header><h3 class="modal-title centered">Album Lot:</h3></div><div class=modal-body><input ng-model=selected.lot placeholder="&lt;Album Lot&gt;"><br><div id=lot-list><div ng-repeat="lot in lots | filter:selected.lot" ng-click=pick_lot(lot.id) class=choice><span>{{ lot.lot }}</span></div></div></div><div class=modal-footer><span ng-click=save() class="btn btn-success pull-right">Save</span></div></div>'),a.put("app/main/list/albums.html","<div ui-view=album_list ng-show=\"$state.includes('main.list.album.album_list')\"></div><div ui-view=album_details ng-show=\"$state.includes('main.list.album.album_details')\"></div>"),a.put("app/main/list/albums/albums.html",'<h3 class=centered>Albums</h3><table id=album-table class="table table-bordered table-condensed table-hover"><thead><tr><th width=40></th><th>Title</th><th>Artist</th><th>Genres</th></tr></thead><tbody><tr ng-repeat="item in albums" ui-sref="main.list.album.album_details({id: item.id})"><td ng-click="remove($index); $event.stopPropagation()" class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ item.title }}</td><td>{{ format(item.artists, \'name\') }}</td><td>{{ format(item.genres, \'name\') }}</td></tr></tbody><tfoot><tr><td ui-sref="main.list.album.album_details({id: 0})" class=centered><span class="glyphicon glyphicon-plus-sign"></span></td><td colspan=3>Add an album ...</td></tr></tfoot></table>'),a.put("app/main/list/genre_details/genre_details.html",'<h3 class=centered>Genre: {{ genre.name }}</h3><h4>Albums:</h4><table class="table table-bordered table-condensed"><thead><tr><th width=40></th><td>Title</td><td>Artist</td><td>Genres</td></tr></thead><tbody><tr ng-repeat="album in albums"><td ng-click="remove(albums[$index].id); $event.stopPropagation()" class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ album.title }}</td><td>{{ album.artist.name }}</td><td>{{ format(album.genres) }}</td></tr></tbody></table>'),a.put("app/main/list/genres.html","<div ui-view=genre_list ng-show=\"$state.includes('main.list.genre.genre_list')\"></div><div ui-view=genre_details ng-show=\"$state.includes('main.list.genre.genre_details')\"></div>"),a.put("app/main/list/genres/genres.html",'<h3 class=centered>Genres</h3><table class="table table-bordered table-condensed table-hover"><thead><tr><th width=40></th><th>Genre</th></tr></thead><tbody><tr ng-repeat="genre in genres" ui-sref="main.list.genre.genre_details({id: genre.id})"><td ng-click="remove($index); $event.stopPropagation()" class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ genre.name }}</td></tr></tbody><tfoot><tr><td class=centered><span ng-click=addGenre() class="glyphicon glyphicon-plus-sign"></span></td><td>Add a genre ...</td></tr></tfoot></table>'),a.put("app/main/list/list.html","<uib-tabset active=tab><uib-tab heading=Albums ng-click=\"pop('main.list.album', 'album_list')\"><div ui-view=albums></div></uib-tab><uib-tab heading=Genres ng-click=\"pop('main.list.genre', 'genre_list')\"><div ui-view=genres></div></uib-tab><uib-tab heading=People ng-click=\"pop('main.list.people', 'people_list')\"><div ui-view=people></div></uib-tab></uib-tabset>"),a.put("app/main/list/people.html","<div ui-view=people_list ng-show=\"$state.includes('main.list.people.people_list')\"></div>"),a.put("app/main/list/people/people.html",'<div id=people><uib-tabset><uib-tab heading=People><h3 class=centered>People</h3><table class="table table-bordered table-condensed table-hover"><thead><tr><th width=40></th><th>Name</th></tr></thead><tbody><tr ng-repeat="person in people"><td ng-click="removePerson($index); $event.stopPropagation()" class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ person.name }}</td></tr></tbody><tfoot><tr><td class=centered><span ng-click=addPerson() class="glyphicon glyphicon-plus-sign"></span></td><td>Add a person ...</td></tr></tfoot></table></uib-tab><uib-tab heading=Roles><h3 class=centered>Roles</h3><table class="table table-bordered table-condensed table-hover"><thead><tr><th width=40></th><th>Role</th></tr></thead><tbody><tr ng-repeat="role in roles"><td ng-click="removeRole($index); $event.stopPropagation()" class=centered><span class="glyphicon glyphicon-minus-sign"></span></td><td>{{ role.role }}</td></tr></tbody><tfoot><tr><td class=centered><span ng-click=addRole() class="glyphicon glyphicon-plus-sign"></span></td><td>Add a role ...</td></tr></tfoot></table></uib-tab></uib-tabset></div>'),a.put("app/main/main.html",'<nav class="navbar navbar-fixed-top navbar-inverse"><div class=container-fluid><div class=navbar-header><a ui-sref=main.list.album.album_list class=navbar-brand><img src=assets/images/xer-t.png width="50"></a> <button ng-init="visible = false" ng-click="visible = !visible" class=navbar-toggle><span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div ng-class="{in: visible}" class="navbar-collapse collapse"><ul class="nav navbar-nav"><li><a><h4>State: {{ $state.current.name }}</h4></a></li></ul><ul class="nav navbar-nav navbar-right"><li uib-dropdown=uib-dropdown auto-close=outsideClick is-open=loginForm.isOpen ng-hide=user.loggedIn><a uib-dropdown-toggle=uib-dropdown-toggle><h4>Login&nbsp<span class=caret></span></h4></a><ul uib-dropdown-menu=uib-dropdown-menu class="dropdown-menu dropdown-menu-centered"><li><button class="btn btn-danger login-button">Login with Google</button></li><div class=hr-text><span>Or</span></div><li><button class="btn btn-primary login-button">Login with Facebook</button></li><div class=hr-text><span>Or</span></div><li><form class=navbar-form><div class=form-group><input ng-model=user.username placeholder=Username focus-if=loginForm.isOpen class="form-control"></div><div class=form-group><input type=password ng-model=user.password placeholder=Password class="form-control"></div><button ng-click=login() class="btn btn-warning login-button">Login with Username</button></form></li></ul></li><li uib-dropdown=uib-dropdown ng-hide=!user.loggedIn><a uib-dropdown-toggle=uib-dropdown-toggle><h4>{{user.name}}&nbsp<span class=caret></span></h4></a><ul uib-dropdown-menu=uib-dropdown-menu class=dropdown-menu><li><a ui-sref=main.settings>Settings</a></li><li class=nav-divider></li><li><a ng-click=logout()>Logout</a></li></ul></li></ul></div></div></nav><div class=ui-body><div class=container><ui-view></ui-view></div></div>'),a.put("app/settings/settings.html","<h2 class=centered>Settings for: {{ user.username }}</h2><uib-tabset><uib-tab heading=Me><h3>User Name: {{ user.name }}</h3><h3>is Admin:</h3></uib-tab><uib-tab heading=Users><h2>List of users...</h2></uib-tab></uib-tabset>")}]),angular.module("grooves").service("Album",["$resource",function(a){var b={remove_track:{method:"DELETE",url:"/api/albums/:album_id/tracks/:track_id"},add_track:{method:"POST",url:"/api/albums/:album_id/tracks"},update_track:{method:"POST",url:"/api/albums/:album_id/tracks/:track_id"
}},c=a("/api/albums/:id",{id:"@id"},b);return c.prototype.$add_track=function(a){return c.add_track({album_id:this.id},a).$promise},c.prototype.$remove_track=function(a){return c.remove_track({album_id:this.id,track_id:a.id}).$promise},c.prototype.$update_track=function(a){return c.update_track({album_id:this.id,track_id:a.id},a).$promise},c}]),angular.module("grooves").service("Artist",["$resource",function(a){var b={addToAlbum:{method:"POST",url:"/api/artists/:id/album/:album_id"},removeFromAlbum:{method:"DELETE",url:"/api/artists/:id/album/:album_id"}},c=a("/api/artists/:id",{id:"@id"},b);return c.prototype.$addToAlbum=function(a){return c.addToAlbum({id:this.id,album_id:a},{}).$promise},c.prototype.$removeFromAlbum=function(a){return c.removeFromAlbum({id:this.id,album_id:a}).$promise},c}]),angular.module("grooves").service("Genre",["$resource",function(a){var b={remove_album:{method:"DELETE",url:"/api/genres/:genre_id/albums/:album_id"}},c=a("/api/genres/:id",{id:"@id"},b);return c.prototype.$remove_album=function(a){return c.remove_album({genre_id:this.id,album_id:a}).$promise},c}]).service("Genres",["Genre",function(a){var b=[];return b.$promise=a.query({},function(c){angular.copy(c,b),b.add_genre=function(c){var d=new a(c);d.$save({},function(a){b.push(a)})},b.remove_genre=function(a){a>=0&&a<b.length&&b[a].$delete({},function(){b.splice(a,1)})},b.update_genre=function(){}}).$promise,b}]),angular.module("grooves").service("Label",["$resource",function(a){var b=a("/api/labels/:id",{id:"@id"});return b}]),angular.module("grooves").service("Lot",["$resource",function(a){var b=a("/api/lots/:id",{id:"@id"});return b}]),angular.module("grooves").service("Person",["$resource",function(a){return a("/api/people/:id",{id:"@id"})}]).service("Role",["$resource",function(a){return a("/api/roles/:role_id",{role_id:"@id"})}]).service("Contribution",["$resource",function(a){return a("/api/contributions/:id",{id:"@id"})}]),angular.module("grooves").service("User",["$resource",function(a){var b={get:{method:"GET",url:"/api/users/me"},login:{method:"POST",url:"/auth/local"},logout:{method:"GET",url:"/auth/logout"}},c=a("/api/users/:id",{id:"@id"},b);return c.prototype.$login=function(a,b){var d=this;return c.login({username:a,password:b},function(a){angular.merge(d,a)}).$promise},c.prototype.$logout=function(){var a=this;return c.logout({},function(b){angular.merge(a,b)}).$promise},c.get()}]);